:original_name: rms_04_0504.html

.. _rms_04_0504:

Querying All Rules
==================

Function
--------

This API is used to query all rules.

Calling Method
--------------

For details, see :ref:`Calling APIs <rms_03_0000>`.

URI
---

GET /v1/resource-manager/domains/{domain_id}/policy-assignments

.. table:: **Table 1** Path Parameters

   +-----------------+-----------------+-----------------+-----------------+
   | Parameter       | Mandatory       | Type            | Description     |
   +=================+=================+=================+=================+
   | domain_id       | Yes             | String          | Specifies tags. |
   |                 |                 |                 |                 |
   |                 |                 |                 | Maximum: **36** |
   +-----------------+-----------------+-----------------+-----------------+

.. table:: **Table 2** Query Parameters

   +------------------------+-----------------+-----------------+----------------------------------------------------+
   | Parameter              | Mandatory       | Type            | Description                                        |
   +========================+=================+=================+====================================================+
   | policy_assignment_name | No              | String          | Specifies the assignment name.                     |
   |                        |                 |                 |                                                    |
   |                        |                 |                 | Maximum: **64**                                    |
   +------------------------+-----------------+-----------------+----------------------------------------------------+
   | limit                  | No              | Integer         | Specifies the maximum number of records to return. |
   |                        |                 |                 |                                                    |
   |                        |                 |                 | Minimum: **1**                                     |
   |                        |                 |                 |                                                    |
   |                        |                 |                 | Maximum: **500**                                   |
   |                        |                 |                 |                                                    |
   |                        |                 |                 | Default: **500**                                   |
   +------------------------+-----------------+-----------------+----------------------------------------------------+
   | marker                 | No              | String          | Specifies the pagination parameter.                |
   |                        |                 |                 |                                                    |
   |                        |                 |                 | Minimum: **4**                                     |
   |                        |                 |                 |                                                    |
   |                        |                 |                 | Maximum: **400**                                   |
   +------------------------+-----------------+-----------------+----------------------------------------------------+

Request Parameters
------------------

.. table:: **Table 3** Request header parameters

   +------------------+-----------+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter        | Mandatory | Type   | Description                                                                                                                                                    |
   +==================+===========+========+================================================================================================================================================================+
   | X-Auth-Token     | No        | String | Specifies the invoker's token.                                                                                                                                 |
   +------------------+-----------+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | X-Security-Token | No        | String | Security token (session token) for temporary security credentials. This parameter is mandatory when you make an API call using temporary security credentials. |
   +------------------+-----------+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+

Response Parameters
-------------------

**Status code: 200**

.. table:: **Table 4** Response body parameters

   +-----------+-----------------------------------------------------------------------------------+----------------------------------+
   | Parameter | Type                                                                              | Description                      |
   +===========+===================================================================================+==================================+
   | value     | Array of :ref:`PolicyAssignment <rms_04_0504__response_policyassignment>` objects | Specifies rules.                 |
   +-----------+-----------------------------------------------------------------------------------+----------------------------------+
   | page_info | :ref:`PageInfo <rms_04_0504__response_pageinfo>` object                           | Specifies the pagination object. |
   +-----------+-----------------------------------------------------------------------------------+----------------------------------+

.. _rms_04_0504__response_policyassignment:

.. table:: **Table 5** PolicyAssignment

   +------------------------+----------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter              | Type                                                                                   | Description                                                                                                                                      |
   +========================+========================================================================================+==================================================================================================================================================+
   | policy_assignment_type | String                                                                                 | Specifies the rule type, which can be **builtin** or **custom**.                                                                                 |
   +------------------------+----------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
   | id                     | String                                                                                 | Specifies the rule ID.                                                                                                                           |
   +------------------------+----------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
   | name                   | String                                                                                 | Specifies the rule name.                                                                                                                         |
   +------------------------+----------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
   | description            | String                                                                                 | Specifies the rule description.                                                                                                                  |
   +------------------------+----------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
   | policy_filter          | :ref:`PolicyFilterDefinition <rms_04_0504__response_policyfilterdefinition>` object    | Specifies the policy filter of a rule.                                                                                                           |
   +------------------------+----------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
   | period                 | String                                                                                 | Specifies how often the rule is triggered, which can be **One_Hour**, **Three_Hours**, **Six_Hours**, **Twelve_Hours**, or **TwentyFour_Hours**. |
   +------------------------+----------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
   | state                  | String                                                                                 | Specifies the rule status.                                                                                                                       |
   +------------------------+----------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
   | created                | String                                                                                 | Specifies the time when the rule was added.                                                                                                      |
   +------------------------+----------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
   | updated                | String                                                                                 | Specifies the time when the rule was modified.                                                                                                   |
   +------------------------+----------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
   | policy_definition_id   | String                                                                                 | Specifies the ID of the policy used by the rule.                                                                                                 |
   +------------------------+----------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
   | custom_policy          | :ref:`CustomPolicy <rms_04_0504__response_custompolicy>` object                        | Specifies the custom rule.                                                                                                                       |
   +------------------------+----------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
   | parameters             | Map<String,\ :ref:`PolicyParameterValue <rms_04_0504__response_policyparametervalue>`> | Specifies the rule parameters.                                                                                                                   |
   +------------------------+----------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
   | tags                   | Array of :ref:`ResourceTag <rms_04_0504__response_resourcetag>` objects                | Tags                                                                                                                                             |
   +------------------------+----------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
   | created_by             | String                                                                                 | Specifies the person who created the rule.                                                                                                       |
   +------------------------+----------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
   | target_type            | String                                                                                 | **traget_type** is reserved for new features usage. In current version the result is null.                                                       |
   +------------------------+----------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
   | target_id              | String                                                                                 | **target_id** is reserved for new features usage. In current version the result is null.                                                         |
   +------------------------+----------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+

.. _rms_04_0504__response_policyfilterdefinition:

.. table:: **Table 6** PolicyFilterDefinition

   +-----------------------+-----------------------+-----------------------------------+
   | Parameter             | Type                  | Description                       |
   +=======================+=======================+===================================+
   | region_id             | String                | Specifies the region ID.          |
   |                       |                       |                                   |
   |                       |                       | Maximum: **128**                  |
   +-----------------------+-----------------------+-----------------------------------+
   | resource_provider     | String                | Specifies the cloud service name. |
   |                       |                       |                                   |
   |                       |                       | Maximum: **128**                  |
   +-----------------------+-----------------------+-----------------------------------+
   | resource_type         | String                | Specifies the resource type.      |
   |                       |                       |                                   |
   |                       |                       | Maximum: **128**                  |
   +-----------------------+-----------------------+-----------------------------------+
   | resource_id           | String                | Specifies the resource ID.        |
   |                       |                       |                                   |
   |                       |                       | Maximum: **512**                  |
   +-----------------------+-----------------------+-----------------------------------+
   | tag_key               | String                | Specifies the tag key.            |
   |                       |                       |                                   |
   |                       |                       | Maximum: **128**                  |
   +-----------------------+-----------------------+-----------------------------------+
   | tag_value             | String                | Specifies the tag value.          |
   |                       |                       |                                   |
   |                       |                       | Maximum: **256**                  |
   +-----------------------+-----------------------+-----------------------------------+

.. _rms_04_0504__response_custompolicy:

.. table:: **Table 7** CustomPolicy

   +-----------------------+-----------------------+-------------------------------------------------------------------------+
   | Parameter             | Type                  | Description                                                             |
   +=======================+=======================+=========================================================================+
   | function_urn          | String                | Specifies the URN of a custom function.                                 |
   |                       |                       |                                                                         |
   |                       |                       | Maximum: **1024**                                                       |
   +-----------------------+-----------------------+-------------------------------------------------------------------------+
   | auth_type             | String                | Specifies how **function** is called by a custom rule.                  |
   +-----------------------+-----------------------+-------------------------------------------------------------------------+
   | auth_value            | Map<String,Object>    | Specifies the parameter value for invoking a function by a custom rule. |
   +-----------------------+-----------------------+-------------------------------------------------------------------------+

.. _rms_04_0504__response_policyparametervalue:

.. table:: **Table 8** PolicyParameterValue

   ========= ====== ==========================================
   Parameter Type   Description
   ========= ====== ==========================================
   value     Object Specifies the value of the rule parameter.
   ========= ====== ==========================================

.. _rms_04_0504__response_resourcetag:

.. table:: **Table 9** ResourceTag

   +-----------------------+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter             | Type                  | Description                                                                                                                           |
   +=======================+=======================+=======================================================================================================================================+
   | key                   | String                | Tag key. A tag key can contain up to 128 Unicode characters and must complay with the character set specifications in section 3.1.    |
   |                       |                       |                                                                                                                                       |
   |                       |                       | Minimum: **1**                                                                                                                        |
   |                       |                       |                                                                                                                                       |
   |                       |                       | Maximum: **128**                                                                                                                      |
   +-----------------------+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------+
   | value                 | String                | Tag value. A tag value can contain up to 255 Unicode characters and must comply with the character set specifications in section 3.2. |
   |                       |                       |                                                                                                                                       |
   |                       |                       | Minimum: **0**                                                                                                                        |
   |                       |                       |                                                                                                                                       |
   |                       |                       | Maximum: **255**                                                                                                                      |
   +-----------------------+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------+

.. _rms_04_0504__response_pageinfo:

.. table:: **Table 10** PageInfo

   +-----------------------+-----------------------+------------------------------------------------------+
   | Parameter             | Type                  | Description                                          |
   +=======================+=======================+======================================================+
   | current_count         | Integer               | Specifies the resource quantity on the current page. |
   |                       |                       |                                                      |
   |                       |                       | Minimum: **0**                                       |
   |                       |                       |                                                      |
   |                       |                       | Maximum: **200**                                     |
   +-----------------------+-----------------------+------------------------------------------------------+
   | next_marker           | String                | Specifies the **marker** value of the next page.     |
   |                       |                       |                                                      |
   |                       |                       | Minimum: **4**                                       |
   |                       |                       |                                                      |
   |                       |                       | Maximum: **400**                                     |
   +-----------------------+-----------------------+------------------------------------------------------+

**Status code: 400**

.. table:: **Table 11** Response body parameters

   ========== ====== ============================
   Parameter  Type   Description
   ========== ====== ============================
   error_code String Specifies the error code.
   error_msg  String Specifies the error message.
   ========== ====== ============================

**Status code: 403**

.. table:: **Table 12** Response body parameters

   ========== ====== ============================
   Parameter  Type   Description
   ========== ====== ============================
   error_code String Specifies the error code.
   error_msg  String Specifies the error message.
   ========== ====== ============================

**Status code: 500**

.. table:: **Table 13** Response body parameters

   ========== ====== ============================
   Parameter  Type   Description
   ========== ====== ============================
   error_code String Specifies the error code.
   error_msg  String Specifies the error message.
   ========== ====== ============================

Example Requests
----------------

None

Example Responses
-----------------

**Status code: 200**

Operation succeeded.

.. code-block::

   {
     "value": [
       {
         "policy_assignment_type": "builtin",
         "id": "6672d6b0354ba95beef328d1",
         "name": "allowed-ecs-flavors",
         "description": "An ECS is noncompliant if its flavor is not in the specified flavor list.",
         "policy_filter": {
           "region_id": null,
           "resource_provider": "ecs",
           "resource_type": "cloudservers",
           "resource_id": null,
           "tag_key": null,
           "tag_value": null
         },
         "period": null,
         "state": "Enabled",
         "created": "2024-06-19T13:01:36.397Z",
         "updated": "2024-06-19T13:01:36.397Z",
         "policy_definition_id": "5f8d549bffeecc14f1fb522a",
         "custom_policy": null,
         "parameters": {
           "listOfAllowedFlavors": {
             "value": []
           }
         },
         "tags": [],
         "created_by": "custom",
         "target_type": null,
         "target_id": null
       },
       {
         "policy_assignment_type": "builtin",
         "id": "6672d83777c56f4aeb50b892",
         "name": "allowed-ecs-flavorss",
         "description": "An ECS is noncompliant if its flavor is not in the specified flavor list.",
         "policy_filter": {
           "region_id": null,
           "resource_provider": "ecs",
           "resource_type": "cloudservers",
           "resource_id": null,
           "tag_key": null,
           "tag_value": null
         },
         "period": null,
         "state": "Enabled",
         "created": "2024-06-19T13:08:07.771Z",
         "updated": "2024-06-19T13:08:07.771Z",
         "policy_definition_id": "5f8d549bffeecc14f1fb522a",
         "custom_policy": null,
         "parameters": {
           "listOfAllowedFlavors": {
             "value": []
           }
         },
         "tags": [],
         "created_by": "custom",
         "target_type": null,
         "target_id": null
       }
     ],
     "page_info": {
       "current_count": 2,
       "next_marker": null
     }
   }

Status Codes
------------

+-------------+---------------------------------------------------------------------+
| Status Code | Description                                                         |
+=============+=====================================================================+
| 200         | Operation succeeded.                                                |
+-------------+---------------------------------------------------------------------+
| 400         | Invalid parameters.                                                 |
+-------------+---------------------------------------------------------------------+
| 403         | Authentication failed or you do not have the operation permissions. |
+-------------+---------------------------------------------------------------------+
| 500         | Server error.                                                       |
+-------------+---------------------------------------------------------------------+

Error Codes
-----------

See :ref:`Error Codes <errorcode>`.
